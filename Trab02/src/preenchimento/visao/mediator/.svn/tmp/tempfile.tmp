package preenchimento.visao.mediator;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;
import java.util.List;

import javax.swing.JOptionPane;

import preenchimento.visao.gui.DialogoPonto;
import preenchimento.visao.gui.JanelaPrincipal;


import componentes.modelo.formas.Poligono;
import componentes.modelo.formas.Ponto;

public class MediatorPrincipal {
	private JanelaPrincipal janelaFormas;

	public MediatorPrincipal(JanelaPrincipal janelaFormas) {
		super();
		this.janelaFormas = janelaFormas;
	}

	public void registraEventos() {
		janelaFormas.getBtnCriarPoligono().addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent arg0) {				
				criarPoligono();				
			}
		});
		janelaFormas.getBtnSair().addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent arg0) {
				System.exit(0);
			}
		});
	}

	private void desenharForma(int opcao) {
		switch (opcao) {
		case 1:
			//criarQuadrado();
			break;
			
		case 2:
			//criarRetangulo();
			break;
			
		case 3:
			criarPoligono();
			break;
		}
	}

	
	private void criarPoligono() {
		// Obter parâmetros do objeto
		ArrayList<Ponto> listaArestas;	
		List<Integer> listaSombreamento;
		DialogoPonto dialogoPonto;
		Ponto ponto;
		Poligono poligono;
		int passo;
		listaArestas = new ArrayList<Ponto>();
		// Obter parâmetros
		do{
			dialogoPonto = new DialogoPonto(janelaFormas,
					"Entre com uma aresta do polígono.", "Adicionar", "Terminar");
			ponto = dialogoPonto.getPonto();
			if(ponto!=null)
				listaArestas.add(ponto);
		}while(ponto != null);

		if (listaArestas.size() < 2)
		{
			JOptionPane.showMessageDialog(janelaFormas, "Insira ao menos 3 pontos para o poligono!", "Erro", JOptionPane.ERROR_MESSAGE);
			return;
		}
		
		try{
			passo = Integer.parseInt(JOptionPane.showInputDialog("Digite o valor do passo:","1"));
		}
		catch(NumberFormatException e){
			JOptionPane.showMessageDialog(janelaFormas, "Valor para passo inválido!", "Erro", JOptionPane.ERROR_MESSAGE);
			return;
		}
		// Instanciar objeto
		poligono = new Poligono(listaArestas, passo);
		
		// Desenhar
		if (poligono.getFormas().size() == 0)
		{
			JOptionPane.showMessageDialog(janelaFormas, "Nao foi possivel formar poligono com esta sequencia de pontos!", "Erro", JOptionPane.ERROR_MESSAGE);
			return;
		}
		
		janelaFormas.getPnlAreaDesenho().adicionarFormaDesenhavel(poligono);
		janelaFormas.getPnlAreaDesenho().repaint();
		
	}
}
